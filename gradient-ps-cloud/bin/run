#! /usr/bin/env bash

# terraform apply reads terraform vars from env that are prefixed TF_VARS_
if [ $IS_MANAGED == "true" ] ; then
  terraform init -backend-config="../backends/managed.tf"
else
  terraform init
fi
terraform workspace new $TF_VAR_cluster_handle || true
terraform workspace select $TF_VAR_cluster_handle
terraform apply -auto-approve
